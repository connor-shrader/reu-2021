list(x_dif_df["x1", ])
x_dif_df["x1", ][:,1]
x_dif_df["x1", ][:,1]
x_dif_df["x1", ][,1]
x_dif_df["x1", ][1:10,]
x_dif_df["x1", ][1:10]
x_dif_df["x1", ][,1:10]
sum(x_dif_df["x1", ])
length(x_dif_df["x1", ])
lapply(row.names(x_dif_df), sample_mean, df = x_dif_df)
sample_mean <- function(row, df){
total <- sum(df[row,]
n <- length(x_dif_df["x1", ])
samp_avg <- total / (n-1)
}
sample_mean <- function(row, df){
total <- sum(df[row,])
n <- length(x_dif_df["x1", ])
samp_avg <- total / (n-1)
}
lapply(row.names(x_dif_df), sample_mean, df = x_dif_df)
x_dif_df
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model, betas){
x_hat <- coef_df[[1]][model]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
}
p=10
x_dif_df <-  data.frame(lapply(results, x_dif_2, model = "lasso", betas = c(1, 2, -2, 0, 0, 0.5, 3, rep(0, (p-6)))))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df)
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df)
View(coef_variance)
x_dif_df <-  data.frame(lapply(results, x_dif_2, model = "mcp", betas = c(1, 2, -2, 0, 0, 0.5, 3, rep(0, (p-6)))))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
x_dif_df <-  data.frame(lapply(results, x_dif_2, model = "fm", betas = c(1, 2, -2, 0, 0, 0.5, 3, rep(0, (p-6)))))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
View(coef_variance)
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[[1]][model]
betas <- coef_df[[1]][soln]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
}
sample_var <- function(model, coefs_df){
x_dif_df <-  data.frame(lapply(coefs_df, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
}
coef_sample_car <- sample_var(model = "lasso", coefs_df = results)
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
}
sample_var <- function(model, coefs_df){
x_dif_df <-  data.frame(lapply(coefs_df, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
}
coef_sample_car <- sample_var(model = "lasso", coefs_df = results)
coef_sample_var <- sample_var(model = "lasso", coefs_df = results)
View(coef_sample_var)
coef_sample_var <- sample_var(model = "mcp", coefs_df = results)
View(coef_sample_var)
coef_sample_var <- sample_var(model = "lasso", coefs_df = results)
View(coef_sample_var)
coef_sample_var <- sample_var(model = "fm", coefs_df = results)
View(coef_sample_var)
?system.time
source('~/NSFREU/reu-2021/code/variable-selection/monte-carlo.r', echo=TRUE)
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
}
sample_var <- function(model, coefs_df){
x_dif_df <-  data.frame(lapply(coefs_df, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
}
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
x_dif_df <-  data.frame(lapply(coefs_df, x_dif_2, model = model))
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_df){
x_dif_df <-  data.frame(lapply(coefs_df, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
x_dif_df <-  data.frame(lapply(coefs_df, x_dif_2, model = model))
data.frame(lapply(results, x_dif_2, model = "lasso"))
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_df){
x_dif_df <-  data.frame(lapply(coefs_df, x_dif_2, model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
source('~/NSFREU/reu-2021/code/variable-selection/monte-carlo.r', echo=TRUE)
coef_sample_var <- sample_var(model = "lasso", coefs_df = results) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  data.frame(lapply(coefs_list, x_dif_2, model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  data.frame(lapply(coefs_list, x_dif_2, model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <-  data.frame(lapply(coefs_list, x_dif_2, model))
print(x_dif_df)
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results) #sample variance for coefficients of lasso model
source('~/NSFREU/reu-2021/code/variable-selection/monte-carlo.r', echo=TRUE)
coef_sample_var <- sample_var(model = "lasso", coefs_list = results) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_list = results) #sample variance for coefficients of lasso model
x_dif_df <-  data.frame(lapply(results, x_dif_2, "lasso"))
coef_sample_var <- sample_var(model = "lasso", coefs_list = results) #sample variance for coefficients of lasso model
View(coef_sample_var)
View(coef_sample_var)
View(x_dif_df)
coef_sample_var <- sample_var(model = "mcp", coefs_list = results) #sample variance for coefficients of lasso model
View(x_dif_df)
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
source('~/NSFREU/reu-2021/code/variable-selection/monte-carlo.r', echo=TRUE)
x_dif_df <-  data.frame(lapply(coefs_list, x_dif_2, model))
source('~/NSFREU/reu-2021/code/variable-selection/monte-carlo.r', echo=TRUE)
sample_var <- function(model, coefs_list){
x_dif_df <-  data.frame(lapply(coefs_list, x_dif_2, model))
x_dif_df <-  x_dif_df
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  data.frame(lapply(coefs_list, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  data.frame(lapply(coefs_list, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  as.data.frame(lapply(coefs_list, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <<-  as.data.frame(lapply(coefs_list, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- - x_hat + betas
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <<-  as.data.frame(lapply(coefs_list, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
# Run monte_carlo 20 times, each time with 200 observations and 10 predictors.
results <- lapply(seeds, monte_carlo, n = 200, p = 10, method = "independent")
#(lapply(seeds, monte_carlo, n = 200, p = 10, method = "independent"))
results2 <- lapply(seeds, monte_carlo, n = 200, p = 10, method = "symmetric")
#system.time(lapply(seeds, monte_carlo, n = 200, p = 10, method = "symmetric"))
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- -1* (x_hat) + betas
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <<-  as.data.frame(lapply(coefs_list, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
View(x_dif_df)
View(x_dif_df)
coef_sample_var <- sample_var(model = "mcp", coefs_list = results2) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "scad", coefs_list = results2) #sample variance for coefficients of lasso model
View(x_dif_df)
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]][["soln"]]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <<-  as.data.frame(lapply(coefs_list, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
View(x_dif_df)
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][[model]]
betas <- coef_df[["coefficients"]][["soln"]]
x_difference <- - x_hat + betas
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <<-  as.data.frame(lapply(coefs_list, x_dif_2, model = model))
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
View(x_dif_df)
source('~/NSFREU/reu-2021/code/variable-selection/monte-carlo.r', echo=TRUE)
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
coef_variance <- lapply(row.names(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
coef_variance <- lapply(rownames(x_dif_df), sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
names_list <- rownames(x_dif_df)
coef_variance <- lapply(names_list, sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
names_list <- rownames(x_dif_df)
coef_variance <- lapply(names_list, sample_mean) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
names_list <- rownames(x_dif_df)
print(names_list)
print(x_dif_df)
coef_variance <- lapply(names_list, sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][model]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- - x_hat + betas
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
names_list <- rownames(x_dif_df)
print(names_list)
print(x_dif_df)
coef_variance <- lapply(names_list, sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][model]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- - x_hat + betas
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(x_dif_df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
names_list <- rownames(x_dif_df)
print(names_list)
print(x_dif_df)
coef_variance <- lapply(names_list, sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][model]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- - x_hat + betas
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
names_list <- rownames(x_dif_df)
print(names_list)
print(x_dif_df)
coef_variance <- lapply(names_list, sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][model]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- - x_hat + betas
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
names_list <- rownames(x_dif_df)
coef_variance <- lapply(names_list, sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
View(coef_sample_var)
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][model]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
print(x_dif_df)
names_list <- rownames(x_dif_df)
coef_variance <- lapply(names_list, sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
# Calculate sample variance of the coefficients
x_dif_2 <- function(coef_df, model){
x_hat <- coef_df[["coefficients"]][model]
betas <- coef_df[["coefficients"]]["soln"]
x_difference <- betas - x_hat
return(x_difference^2)
}
sample_mean <- function(row, df){  #takes sample mean: sum(x)/(n-1)
total <- sum(df[row,])
n <- length(df[row, ])
samp_avg <- total / (n-1)
return(samp_avg)
}
sample_var <- function(model, coefs_list){
x_dif_df <-  lapply(coefs_list, x_dif_2, model = model)
x_dif_df <- as.data.frame(x_dif_df)
names_list <- rownames(x_dif_df)
coef_variance <- lapply(names_list, sample_mean, df = x_dif_df) #returns list with sample variance for each coefficient in model
return(coef_variance)
}
coef_sample_var <- sample_var(model = "lasso", coefs_list = results2) #sample variance for coefficients of lasso model
View(coef_sample_var)
coef_sample_var <- sample_var(model = "lasso", coefs_list = results1) #sample variance for coefficients of lasso model
coef_sample_var <- sample_var(model = "lasso", coefs_list = results) #sample variance for coefficients of lasso model
View(coef_sample_var)
coef_sample_var <- sample_var(model = "lasso", coefs_list = results) #sample variance for coefficients of lasso model
View(coef_sample_var)

install.packages("broom")
source('~/github/reu-2021/code/figures/empirical-lasso.r', echo=TRUE)
tidied <- tidy(lasso)
library(broom)
tidied <- tidy(lasso)
View(tidied)
0.5070830 - 0.03471334
ggplot(tidied, aes(x = lambda, y = estimate)) +
geom_line()
ggplot(tidied, aes(x = lambda, y = estimate)) +
geom_line() +
scale_x_log10()
plot(lasso)
library(glmnet)
plot(lasso)
View(tidied)
ggplot(tidied, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(ymin = conf.low, ymax = conf.high) +
scale_x_log10()
View(tidied)
?geom_errorbar
ggplot(tidied, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = (ymin = conf.low, ymax = conf.high)) +
scale_x_log10()
ggplot(tidied, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high)) +
scale_x_log10()
ggplot(tidied, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high)) +
scale_x_log10() +
reu
ggplot(tidied, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high)) +
scale_x_log10() +
reu_blank
ggplot(tidied, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high)) +
scale_x_log10() +
reu_border
View(tidied)
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(x = lambda, y = nzero) +
scale_x_log10() +
reu_border
tidied_lasso <- tidy(lasso)
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(x = lambda, y = nzero) +
scale_x_log10() +
reu_border
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero)) +
scale_x_log10() +
reu_border
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero)) +
geom_line(data = tidied_enet, mapping = aes(x = lambda, y = nzero), color = "red") +
scale_x_log10() +
reu_border
tidied_enet <- tidy(enet)
View(tidied_enet)
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero)) +
geom_line(data = tidied_enet, mapping = aes(x = lambda, y = nzero), color = "red") +
scale_x_log10() +
reu_border
tidied_scad <- tidy(scad)
View(tidied_lasso)
View(lasso)
View(scad)
scae$fit$beta
scad$fit$beta
tidied_scad$conf.low <- tidied_scad$estimate - tidied_scad$std.error
tidied_scad <- data.frame(lambda = scad$lambda,
estimate = scad$cve,
std.error = scad$cvse)
tidied_scad$conf.low <- tidied_scad$estimate - tidied_scad$std.error
tidied_scad$conf.high <- tidied_scad$estimate + tidied_scad$std.error
tidied_scad$nzero <- apply(X = scad$fit$beta, MARGIN = 2, FUN = function(col) {
sum(c == 0)
})
tidied_scad$nzero <- apply(X = scad$fit$beta, MARGIN = 2, FUN = function(col) {
print(col)
sum(c == 0)
})
tidied_scad$nzero <- apply(X = scad$fit$beta, MARGIN = 2, FUN = function(col) {
print(class(col))
sum(c == 0)
})
?colSums
colSums(scad$fit$beta != 0)
colSums(scad$fit$beta == 0)
tidied_scad$nzero <- colSums(scad$fit$beta == 0)
View(tidied_scad)
tidied_scad$nzero <- colSums(scad$fit$beta != 0)
View(scad)
scad[["fit"]][["beta"]]
scad$fit$beta[, 1]
print(lasso$glmnet.fit)
print(scad$fit)
View(lasso)
lasso_mat <- lasso$glmnet.fit$beta
lasso_mat <- as.matrix(lasso_mat)
class(lasso_mat)
dim(lasso_mat)
sum(lasso_mat[, 1] != 0)
scad_mat <- scad$fit$beta
sum(scad_mat[, 1] != 0)
sum(scad_mat[, 100] != 0)
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero)) +
geom_line(data = tidied_enet, mapping = aes(x = lambda, y = nzero), color = "red") +
geom_line(data = tidied_scad, mapping = aes(x = lambda, y = nzero), color = "blue") +
scale_x_log10() +
reu_border
tidied_mcp <- data.frame(lambda = mcp$lambda,
estimate = mcp$cve,
std.error = mcp$cvse)
tidied_mcp$conf.low <- tidied_mcp$estimate - tidied_mcp$std.error
tidied_mcp$conf.high <- tidied_mcp$estimate + tidied_mcp$std.error
tidied_mcp$nzero <- colSums(mcp$fit$beta != 0)
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero)) +
geom_line(data = tidied_enet, mapping = aes(x = lambda, y = nzero), color = "red") +
geom_line(data = tidied_scad, mapping = aes(x = lambda, y = nzero), color = "blue") +
geom_line(data = tidied_scad, mapping = aes(x = lambda, y = nzero), color = "green") +
scale_x_log10() +
reu_border
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero)) +
geom_line(data = tidied_enet, mapping = aes(x = lambda, y = nzero), color = "red") +
geom_line(data = tidied_scad, mapping = aes(x = lambda, y = nzero), color = "blue") +
geom_line(data = tidied_mcp, mapping = aes(x = lambda, y = nzero), color = "green") +
scale_x_log10() +
reu_border
plot(scad)
library(ncvreg)
plot(scad)
plot(mcp)
tidied_adap_lasso <- tidy(adap_lasso)
View(adap_lasso)
View(tidied_lasso)
tidied_adap_lasso <- data.frame(lambda = adap_lasso$lambda,
estimate = adap_lasso$cvm,
st.error = adap_lasso$cvsd)
tidied_adap_lasso$conf.low <- tidied_adap_lasso$estimate - tidied_adap_lasso$std.error
tidied_adap_lasso$conf.high <- tidied_adap_lasso$estimate + tidied_adap_lasso$std.error
tidied_adap_lasso$nzero <- adap_lasso$nzero
tidied_adap_lasso <- data.frame(lambda = adap_lasso$lambda,
estimate = adap_lasso$cvm,
st.error = adap_lasso$cvsd)
tidied_adap_lasso$conf.low <- tidied_adap_lasso$estimate - tidied_adap_lasso$std.error
View(tidied_adap_lasso)
tidied_adap_lasso <- data.frame(lambda = adap_lasso$lambda,
estimate = adap_lasso$cvm,
std.error = adap_lasso$cvsd)
tidied_adap_lasso$conf.low <- tidied_adap_lasso$estimate - tidied_adap_lasso$std.error
tidied_adap_lasso$conf.high <- tidied_adap_lasso$estimate + tidied_adap_lasso$std.error
tidied_adap_lasso$nzero <- adap_lasso$nzero
View(tidied_adap_lasso)
View(tidied_lasso)
tidied_adap_enet <- data.frame(lambda = adap_enet$lambda,
estimate = adap_enet$cvm,
std.error = adap_enet$cvsd)
tidied_adap_enet$conf.low <- tidied_adap_enet$estimate - tidied_adap_enet$std.error
tidied_adap_enet$conf.high <- tidied_adap_enet$estimate + tidied_adap_enet$std.error
tidied_adap_enet$nzero <- adap_enet$nzero
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero)) +
geom_line(data = tidied_enet, mapping = aes(x = lambda, y = nzero), color = "red") +
geom_line(data = tidied_scad, mapping = aes(x = lambda, y = nzero), color = "blue") +
geom_line(data = tidied_mcp, mapping = aes(x = lambda, y = nzero), color = "green") +
geom_line(data = tidied_adap_lasso, mapping = aes(x = lambda, y = nzero), color = "orange") +
geom_line(data = tidied_adap_enet, mapping = aes(x = lambda, y = nzero), color = "purple") +
scale_x_log10() +
reu_border
View(tidied_adap_enet)
View(tidied_adap_enet)
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero)) +
geom_line(data = tidied_enet, mapping = aes(x = lambda, y = nzero), color = "red") +
geom_line(data = tidied_scad, mapping = aes(x = lambda, y = nzero), color = "blue") +
geom_line(data = tidied_mcp, mapping = aes(x = lambda, y = nzero), color = "green") +
geom_line(data = tidied_adap_lasso, mapping = aes(x = lambda, y = nzero), color = "orange") +
geom_line(data = tidied_adap_enet, mapping = aes(x = lambda, y = nzero), color = "purple") +
scale_x_log10() +
reu_border
View(tidied_adap_lasso)
tidied_adap_lasso$nzero - tidied_adap_enet$nzero
?rbind
tidied_dataframes <- list(tidied_lasso, tidied_enet, tidied_adap_lasso,
tidied_adap_enet, tidied_scad, tidied_mcp)
tidied_lasso$model <- "lasso"
View(tidied_lasso)
tidied_lasso$model_name <- "lasso"
tidied_enet$model_name <- "enet"
tidied_adap_lasso$model_name <- "adap_lasso"
tidied_adap_enet$model_name <- "adap_enet"
tidied_scad$model_name <- "scad"
tidied_mcp$model_name <- "mcp"
tidied_info <- rbindlist(tidied_lasso, tidied_enet, tidied_adap_lasso, tidied_adap_enet,
tidied_scad, tidied_mcp)
tidied_info <- do.call("rbind", list(tidied_lasso, tidied_enet, tidied_adap_lasso, tidied_adap_enet,
tidied_scad, tidied_mcp))
View(tidied_lasso)
tidied_lasso <- tidy(lasso)
tidied_lasso$model_name <- "lasso"
tidied_info <- do.call("rbind", list(tidied_lasso, tidied_enet, tidied_adap_lasso, tidied_adap_enet,
tidied_scad, tidied_mcp))
View(tidied_info)
ggplot(tidied_info, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero, color = model_name)) +
scale_x_log10() +
reu_border
tidied_info$model_name <- as.factor(tidied_info$model_name)
tidied_info$model_name
tidied_adap_lasso$nzero - tidied_adap_enet$nzero
View(adap_lasso)
View(adap_enet)
best_lambdas <- c(lasso$lambda.min, enet$lambda.min, adap_lasso$lambda.min,
adap_enet$lambda.min, scad$lambda.min, mcp$lambda.min)
lasso
View(lasso)
View(scad)
View(mcp)
View(adap_enet)
View(adap_enet)
best_nzero <- c(tidied_lasso$nzero[best_lambdas[1]], tidied_enet$nzero[best_lambas[2]],
tidied_adap_lasso$nzero[best_lambdas[3]], tidied_adap_enet$nzero[best_lambdas[4]],
tidied_scad$nzero[best_lambdas[5]], tidied_mcp$nzero[best_lambdas[6]])
best_nzero <- c(tidied_lasso$nzero[best_lambdas[1]], tidied_enet$nzero[best_lambdas[2]],
tidied_adap_lasso$nzero[best_lambdas[3]], tidied_adap_enet$nzero[best_lambdas[4]],
tidied_scad$nzero[best_lambdas[5]], tidied_mcp$nzero[best_lambdas[6]])
best_lambdas <- c(lasso$lambda.min, enet$lambda.min, adap_lasso$lambda.min,
adap_enet$lambda.min, scad$lambda.min, mcp$lambda.min)
best_nzero <- c(tidied_lasso$nzero[best_lambdas[1]], tidied_enet$nzero[best_lambdas[2]],
tidied_adap_lasso$nzero[best_lambdas[3]], tidied_adap_enet$nzero[best_lambdas[4]],
tidied_scad$nzero[best_lambdas[5]], tidied_mcp$nzero[best_lambdas[6]])
tidied_lasso$nzero[best_lambdas[1]]
tidied_lasso$nzero
best_lambdas[1]
View(lasso)
?match
View(adap_lasso)
View(tidied_adap_enet)
tidied_lasso[lambda == best_lambdas[1], "nzero"]
tidied_enet[lambda == best_lambdas[2], "nzero"]
tidied_enet[lambda == best_lambdas[2]]
tidied_enet[tidied_enet$lambda == best_lambdas[2]]
tidied_enet[tidied_enet$lambda == best_lambdas[2], ]
tidied_enet[tidied_enet$lambda == best_lambdas[2], "nzero"]
best_index <-
best_nzero <- c(tidied_lasso[tidied_lasso$lambda == best_lambdas[1], "nzero"],
tidied_enet[tidied_enet$lambda == best_lambdas[2], "nzero"],
tidied_adap_lasso[tidied_adap_lasso$lambda == best_lambdas[3], "nzero"],
tidied_adap_enet[tidied_adap_enet$lambda == best_lambdas[4], "nzero"],
tidied_scad[tidied_scad$lambda == best_lambdas[5], "nzero"],
tidied_mcp[tidied_mcp$lambda == best_lambdas[6], "nzero"])
best_nzero
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_point(data = best_values, mapping = aes(x = lambda, y = nzero)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high)) +
scale_x_log10() +
reu_border
best_values <- data.frame(lambda = best_lambdas, nzero = best_nzero)
as.numeric(best_values)
numeric(best_values)
lapply(class, best_nzero)
lapply(class, list(best_nzero))
list(best_nzero)
lapply(class, list(best_nzero))
lapply(list(best_nzero), class)
lapply(best_nzero, class)
as.numeric(best_nzero)
best_values <- data.frame(lambda = best_lambdas, nzero = as.numeric(best_nzero))
best_nzero <- c(tidied_lasso[tidied_lasso$lambda == best_lambdas[1], "nzero"],
tidied_enet[tidied_enet$lambda == best_lambdas[2], "nzero"],
tidied_adap_lasso[tidied_adap_lasso$lambda == best_lambdas[3], "nzero"],
tidied_adap_enet[tidied_adap_enet$lambda == best_lambdas[4], "nzero"],
tidied_scad[tidied_scad$lambda == best_lambdas[5], "nzero"],
tidied_mcp[tidied_mcp$lambda == best_lambdas[6], "nzero"])
best_values <- data.frame(lambda = best_lambdas, nzero = as.numeric(best_nzero))
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high)) +
scale_x_log10() +
reu_border
ggplot(tidied_info, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero, color = model_name)) +
geom_point(data = best_values, mapping = aes(x = lambda, y = nzero)) +
scale_x_log10() +
reu_border
ggplot(tidied_info, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero, color = model_name)) +
geom_point(data = best_values, mapping = aes(x = lambda, y = nzero, color = model_name)) +
scale_x_log10() +
reu_border
best_values <- data.frame(lambda = best_lambdas, nzero = as.numeric(best_nzero), model_name = model_names)
model_names <- c("Lasso", "E-net", "Adap. Lasso", "Adap. e-net", "SCAD", "MCP")
best_values <- data.frame(lambda = best_lambdas, nzero = as.numeric(best_nzero), model_name = model_names)
ggplot(tidied_info, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero, color = model_name)) +
geom_point(data = best_values, mapping = aes(x = lambda, y = nzero, color = model_name)) +
scale_x_log10() +
reu_border
source('~/github/reu-2021/code/figures/empirical-lasso.r', echo=TRUE)
ggplot(tidied_info, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero, color = model_name)) +
geom_point(data = best_values, mapping = aes(x = lambda, y = nzero, color = model_name), size = 5) +
scale_x_log10() +
reu_border
ggplot(tidied_info, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero, color = model_name)) +
geom_point(data = best_values, mapping = aes(x = lambda, y = nzero, color = model_name), size = 3) +
scale_x_log10() +
reu_border
best_values
best_values <- data.frame(model_name = model_names, lambda = best_lambdas, nzero = as.numeric(best_nzero))
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high)) +
scale_x_log10() +
reu_border
reu_border
ggplot(tidied_info, aes(x = lambda, y = estimate)) +
geom_line(mapping = aes(x = lambda, y = nzero, color = model_name)) +
geom_point(data = best_values, mapping = aes(x = lambda, y = nzero, color = model_name), size = 3) +
scale_x_log10() +
labs(x = "lambda", y = "Number of Predictors", color = "Correlation", shape = "Correlation") +
reu_border
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high)) +
scale_x_log10() +
reu_border
plot(lasso)
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_point() +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
scale_x_log10() +
reu_border
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_point() +
scale_x_log10() +
reu_border
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_point() +
scale_x_log10() +
reu_border +
theme(
panel.grid = element_line(color = "gray")
)
ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_point() +
scale_x_log10() +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_point() +
scale_x_log10() +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
geom_point() +
scale_x_log10() +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = lasso$lambda.min) +
geom_vline(xintercept = lasso$lambda.1se) +
geom_point() +
scale_x_log10() +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = lasso$lambda.min, linetype = "dashed") +
geom_vline(xintercept = lasso$lambda.1se) +
geom_point() +
scale_x_log10() +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = c(lasso$lambda.min, lasso$lambda.1se), linetype = "dashed") +
geom_point() +
scale_x_log10() +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = c(lasso$lambda.min, lasso$lambda.1se),
linetype = "dashed",
color = "red") +
geom_point() +
scale_x_log10() +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = lasso$lambda.min,
linetype = "dashed",
color = "red") +
geom_point() +
scale_x_log10() +
labs(x = "lambda", y = "Mean Squared Error") +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = lasso$lambda.min,
linetype = "dashed",
color = "red") +
geom_point() +
scale_x_log10() +
labs(x = expression(lambda), y = "Mean Squared Error") +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = lasso$lambda.min,
linetype = "dashed",
color = "red") +
geom_point() +
scale_x_log10() +
labs(x = "lambda", y = "Mean Squared Error") +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = lasso$lambda.min,
linetype = "dashed",
color = "red") +
geom_point() +
scale_x_log10() +
labs(x = expression(lambda), y = "Mean Squared Error") +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
plot(ridge)
lasso_mse <- ggplot(tidied_lasso, aes(x = lambda, y = estimate)) +
geom_errorbar(mapping = aes(ymin = conf.low, ymax = conf.high), color = "gray") +
geom_vline(xintercept = lasso$lambda.min,
linetype = "dashed",
color = "red") +
geom_point() +
scale_x_log10() +
labs(x = expression(lambda), y = "Mean Squared Error") +
reu_border +
theme(
panel.grid = element_line(color = "gray90")
)
lasso_mse
View(tidied_mcp)
source('~/github/reu-2021/code/figures/empirical-lasso.r', echo=TRUE)
View(adap_ridge)
adap_ridge$nzero
adap_ridge$lambda
View(adap_ridge)
plot(adap_ridge)
library(glmnet)
plot(adap_ridge)
View(mse_df)
View(adap_enet)
set.seed(1)
set.seed(1)

\documentclass{article}

\usepackage[margin = 1in]{geometry}

\usepackage{hyperref} % Clickable ref's
\usepackage{lscape}
\usepackage{ifthen}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{pgffor}
\usepackage[maxfloats=50]{morefloats}

% Clickable link setup
\hypersetup{
	colorlinks=true,
	linkcolor=blue,
	filecolor=magenta,      
	urlcolor=cyan,
	citecolor=blue
}


% https://tex.stackexchange.com/questions/192586/passing-command-output-as-a-parameter-to-the-other-command
% NormalTeXSyntaxON
\def\setcaseA#1 {\expandafter\def\csname a:#1\endcsname}
\def\responseword#1{\expandafter\ifx\csname a:#1\endcsname\relax \adefault 
	\else \csname a:#1\endcsname\fi}

\def\adefault {black}    
\setcaseA 1      {linear} 
\setcaseA 2      {non-linear}  

\def\setcaseB#1 {\expandafter\def\csname b:#1\endcsname}
\def\responsewordnodash#1{\expandafter\ifx\csname b:#1\endcsname\relax \bdefault 
	\else \csname b:#1\endcsname\fi}

\def\bdefault {black}    
\setcaseB 1      {linear} 
\setcaseB 2      {nonlinear} 

\def\setcaseC#1 {\expandafter\def\csname c:#1\endcsname}
\def\typenodash#1{\expandafter\ifx\csname c:#1\endcsname\relax \cdefault 
	\else \csname c:#1\endcsname\fi}

\def\cdefault {black}    
\setcaseC test-mse      {test\_mse} 
\setcaseC train-mse      {train\_mse}  
\setcaseC sensitivity      {sensitivity}  
\setcaseC specificity      {specificity}  

\def\setcaseD#1 {\expandafter\def\csname d:#1\endcsname}
\def\typeword#1{\expandafter\ifx\csname d:#1\endcsname\relax \ddefault 
	\else \csname d:#1\endcsname\fi}

\def\ddefault {black}    
\setcaseD test-mse      {testing MSE} 
\setcaseD train-mse      {training MSE}  
\setcaseD sensitivity      {$\beta$-sensitivity}  
\setcaseD specificity      {$\beta$-specificity}  

% NormalTeXSyntaxOff

% #1: n
% #2: p
% #3: train_mse, test_mse, sensitivity, or specificity
% #4: train-mse, test-mse, sensitivity, or specificity
% #5: response (1 or 2)
% #6: linear or nonlinear
% #7: linear or non-linear
\newcommand{\facetfigureinner}[7]{
	%(#1, #2, #3, #4, #5, #6, #7)
	\begin{figure}[h!]
		\centering
		\includegraphics[width=\textwidth]{figures/#6-facet/#4/facet\_#3\_#5\_#1\_#2.eps}
		\captionsetup{width=0.8\textwidth}
		\caption{Average \typeword{#4} for the #7 simulations when $n = #1$ and $p = #2$. See Table \ref{tab:#6-#4-#1-#2} for the corresponding data.}
		\label{fig:#6-#4-#1-#2}
	\end{figure}
}

% #1: n
% #2: p
% #3: train-mse, test-mse, sensitivity, or specificity
% #4: response (1 or 2)
\newcommand{\facetfigure}[4]{
	\facetfigureinner{#1}{#2}{\typenodash{#3}}{#3}{#4}{\responsewordnodash{#4}}{\responseword{#4}}
}

\newcommand{\facettableinner}[7]{
	\begin{minipage}{\linewidth}
	\centering
	\captionof{table}{Mean and standard deviation of the \typeword{#4} for the #7 simulations when $n = #1$ and $p = #2$. See Figure \ref{fig:#6-#4-#1-#2} for the corresponding visualization.}
	\label{tab:#6-#4-#1-#2}
	\input{tables/#6-facet/#4/facet\_#3\_#5\_#1\_#2.tex}
	\end{minipage}
	%\newpage
}


\newcommand{\facettable}[4]{
	\facettableinner{#1}{#2}{\typenodash{#3}}{#3}{#4}{\responsewordnodash{#4}}{\responseword{#4}}
}

\begin{document}
%\facetfigure{1000}{10}{test-mse}{1}
\maxdeadcycles=500
\newcounter{figuresplaced}

\foreach \response in {1, 2}{
	\section{Figures from the \responseword{\response} simulations}
	\foreach \type in {train-mse, test-mse, sensitivity, specificity}{
		\subsection{Figures for the average \typeword{\type} of the \responseword{\response} simulations}
		\foreach \n in {50, 200, 1000}{
			\foreach \p in {10, 100, 2000}{
				\facetfigure{\n}{\p}{\type}{\response}
				%\stepcounter{figuresplaced}
				%\ifodd\value{figuresplaced}{\ }\else{\newpage}
			}
		}
		\newpage
	}
	\newpage
}

See \ref{fig:linear-test-mse-1000-10}

{\tiny\begin{landscape}
	\centering
	\captionsetup{width = 6in}
	
	
	%\facettable{1000}{10}{train-mse}{1}
	
	\foreach \response in {1, 2}{
		\section{Tables from the \responseword{\response} simulations}
		\foreach \type in {train-mse, test-mse, sensitivity, specificity}{
			\subsection{Tables for the \typeword{\type} of the \responseword{\response} simulations}
			\foreach \n in {50, 200, 1000}{
				\foreach \p in {10, 100, 2000}{
					\facettable{\n}{\p}{\type}{\response}
					%\newpage
					%\stepcounter{figuresplaced}
					%\ifodd\value{figuresplaced}{\ }\else{\newpage}
				}
			}
		}
	}
\end{landscape}}
\end{document}